# 何を入れるか？完全ガイド

超シンプルに説明します。

---

## TL;DR（結論だけ知りたい人向け）

### ローカル（あなたのWSL）に入れるもの

```bash
1. Docker Desktop for Windows （Qdrant用）
2. 何もない（Pythonは既にある）
```

### サーバー（友達のCentOS）に入れるもの

```bash
1. Python 3.9+  （多分もう入ってる）
2. Docker      （Qdrant用）
3. このフォルダ（MindAIgis）全部
```

---

## 詳しい手順

### パターンA: まず自分のWSLで試す（推奨）

#### 必要なもの

1. **Docker Desktop for Windows**
   - ダウンロード: https://www.docker.com/products/docker-desktop/
   - インストール後、WSL統合を有効にする

2. **OpenAI API Key**
   - https://platform.openai.com/api-keys
   - クレカ登録必要（最初$5分くらい無料）

3. **Redmine API Key**
   - 友達のRedmineにアクセス
   - 個人設定 → APIアクセスキー → 表示

#### 手順（コピペでOK）

```bash
# 1. プロジェクトディレクトリへ移動
cd /mnt/c/Users/aotoh/Documents/ClaudeCode/MindAIgis

# 2. 環境変数設定
cp .env.example .env
nano .env
# ↑で以下を編集:
#   OPENAI_API_KEY=あなたのキー
#   REDMINE_URL=http://友達のサーバーIP:ポート
#   REDMINE_API_KEY=取得したキー

# 3. Python環境構築
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 4. 接続テスト
python scripts/test_connection.py

# 5. Docker起動（Docker Desktopが起動してること確認）
docker-compose up -d

# 6. 初期データ投入（10件でテスト）
python scripts/index_tickets.py --limit 10

# 7. 起動
./start.sh

# 8. ブラウザで確認
# http://localhost:8501
```

#### うまくいかない場合

- `SETUP_LOCAL.md` を読む
- `scripts/test_connection.py` でどこがダメか確認

---

### パターンB: サーバーに入れる（本番）

#### 友達にお願いすること

「以下をインストールしてほしい」と伝える:

```bash
# Python 3.9+
sudo yum install -y python3 python3-pip

# Docker
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
sudo systemctl start docker
sudo systemctl enable docker

# あなたのユーザーをdockerグループに追加
sudo usermod -aG docker あなたのユーザー名
```

#### あなたがやること

```bash
# 1. サーバーにSSH接続
ssh ユーザー名@サーバーIP

# 2. 作業ディレクトリ作成
mkdir -p ~/mindaigis
cd ~/mindaigis

# 3. ファイル転送（ローカルから）
# ローカルのWSLで実行:
cd /mnt/c/Users/aotoh/Documents/ClaudeCode/MindAIgis
scp -r * ユーザー名@サーバーIP:~/mindaigis/

# 4. サーバーで設定
cd ~/mindaigis
cp .env.example .env
vim .env
# REDMINE_URLは localhost:ポート でOK（同じサーバーだから）

# 5. Python環境
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 6. 接続テスト
python scripts/test_connection.py

# 7. Docker起動
docker-compose up -d

# 8. 初期データ投入
python scripts/index_tickets.py --limit 10

# 9. 起動
./start.sh

# 10. 外部からアクセスできるようにファイアウォール設定
sudo firewall-cmd --permanent --add-port=8501/tcp
sudo firewall-cmd --reload
```

#### ブラウザでアクセス

```
http://サーバーのIP:8501
```

---

## よくある質問

### Q: Dockerって何に使うの？

A: Qdrant（ベクトルDB）を動かすため。MySQL/PostgreSQLのベクトル版みたいなもの。

### Q: Dockerなしでも動く？

A: ベクトル検索は使えないけど、Redmine接続テストはできる。

### Q: サーバーに何GB必要？

A:
- プログラム本体: 100MB以下
- Qdrantデータ: チケット1万件で約1GB
- Python環境: 500MB程度
- **合計: 2GB あれば余裕**

### Q: Redmineに影響ある？

A: **まったくない**。読み取り専用でAPIを叩くだけ。

### Q: OpenAI API、月いくらかかる？

A:
- Embedding: 1000件で約$0.50
- 月1万件検索しても$5程度
- **ほぼタダ**

### Q: 友達に何を伝えればいい？

A:
```
「Python 3.9とDockerを入れてほしい」
「ファイアウォールで8501番ポートを開けてほしい」

以下のコマンドを実行してもらう:
sudo yum install -y python3 docker-ce docker-ce-cli containerd.io
sudo systemctl start docker
sudo usermod -aG docker ユーザー名
sudo firewall-cmd --permanent --add-port=8501/tcp
sudo firewall-cmd --reload
```

### Q: うまくいかない！

A:
1. `python scripts/test_connection.py` を実行
2. どこでエラーが出るか確認
3. エラーメッセージを教えて

---

## ファイル構成（どれを転送するか）

### 必須ファイル

```
MindAIgis/
├── app/              ← 必須（コア）
├── ui/               ← 必須（画面）
├── scripts/          ← 必須（初期化）
├── requirements.txt  ← 必須（依存関係）
├── docker-compose.yml← 必須（Qdrant）
├── .env              ← 作成する（設定）
├── start.sh          ← 便利（起動）
└── stop.sh           ← 便利（停止）
```

### 不要なファイル（転送しなくてOK）

```
venv/           ← サーバーで作り直す
__pycache__/    ← 自動生成される
qdrant_storage/ ← サーバーで作られる
*.md            ← ドキュメント（なくても動く）
```

---

## チェックリスト

### ローカルテスト

- [ ] Docker Desktop インストール済み
- [ ] OpenAI API Key 取得済み
- [ ] Redmine API Key 取得済み
- [ ] .env ファイル作成済み
- [ ] `pip install -r requirements.txt` 成功
- [ ] `python scripts/test_connection.py` すべてOK
- [ ] `docker-compose up -d` 成功
- [ ] http://localhost:8501 でUI表示

### サーバーデプロイ

- [ ] サーバーにSSHログインできる
- [ ] Python 3.9+ インストール済み
- [ ] Docker インストール済み
- [ ] ファイル転送完了
- [ ] .env 作成（REDMINE_URLはlocalhost）
- [ ] `pip install -r requirements.txt` 成功
- [ ] `python scripts/test_connection.py` すべてOK
- [ ] ファイアウォール設定済み
- [ ] http://サーバーIP:8501 でUI表示

---

## 次に読むドキュメント

1. **今すぐ試す**: `QUICKSTART.md`
2. **ローカル詳細**: `SETUP_LOCAL.md`
3. **サーバー詳細**: `DEPLOY_SERVER.md`
4. **systemd設定**: `systemd/INSTALL.md`
5. **全体像**: `README.md`

---

## 緊急連絡先

困ったら:
1. `python scripts/test_connection.py` 実行
2. エラーメッセージコピー
3. どこまでできたか教えて
